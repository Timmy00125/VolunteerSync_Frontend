<div class="max-w-7xl mx-auto p-5">
  @if (isLoading()) {
  <div class="flex flex-col items-center justify-center p-10 text-center">
    <mat-spinner class="mb-4"></mat-spinner>
    <p class="text-gray-600">Loading profile...</p>
  </div>
  } @else if (error()) {
  <div class="flex flex-col items-center justify-center p-10 text-center">
    <mat-icon color="warn" class="text-5xl w-12 h-12 mb-4">error</mat-icon>
    <h2 class="text-xl font-medium mb-2 text-gray-900">Unable to Load Profile</h2>
    <p class="text-red-600 mb-4 max-w-md">{{ error() }}</p>
    @if (error()?.includes("Network connection failed") || error()?.includes("Network error")) {
    <div class="mb-4 text-left max-w-md bg-blue-50 border border-blue-200 rounded p-4">
      <p class="text-sm text-gray-700 mb-2"><strong>Common solutions:</strong></p>
      <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
        <li>
          Ensure the backend server is running at
          <code class="bg-gray-100 px-1 rounded">http://localhost:8081/graphql</code>
        </li>
        <li>Check your internet connection</li>
        <li>Verify your firewall settings aren't blocking the connection</li>
      </ul>
    </div>
    <button mat-raised-button color="primary" (click)="loadProfile()">
      <mat-icon>refresh</mat-icon>
      Retry
    </button>
    } @else if (error()?.includes("Authentication")) {
    <p class="text-gray-600 mb-4 text-sm max-w-md">
      Your session may have expired. Please try logging in again.
    </p>
    <button mat-raised-button color="primary" (click)="goToLogin()">Go to Login</button>
    } @else {
    <button mat-raised-button color="primary" (click)="loadProfile()">
      <mat-icon>refresh</mat-icon>
      Retry
    </button>
    }
  </div>
  } @else if (profile()) {
  <mat-card class="mb-6">
    <mat-card-header>
      <mat-card-title>Profile</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <h1 class="text-2xl font-medium mb-2">{{ displayName() }}</h1>
      <p class="text-gray-600 mb-4">{{ userEmail() }}</p>
      @if (profile()?.bio) {
      <p class="text-base leading-relaxed">{{ profile()?.bio }}</p>
      }
    </mat-card-content>
  </mat-card>
  } @else {
  <div class="flex flex-col items-center justify-center p-10 text-center">
    <mat-icon class="text-6xl text-gray-400 mb-4">person</mat-icon>
    <h2 class="text-2xl font-medium text-gray-600 mb-4">Profile not found</h2>
    <button mat-raised-button color="primary" [routerLink]="['/dashboard']">
      Back to Dashboard
    </button>
  </div>
  }
</div>
